from compiler.utils.stack_automata_class import StackAutomata
from compiler.utils.stack_automata_class import SyntacticTable

# tabela de transição implementada na forma de dicionário aonde as chaves são duplas e os valores são strings
# syntactic_table[(estado_atual, entrada)] = ação
# se não houver o símbolo na tabela, retornar ERROR
# a tabela goto deve ser implementada da mesma forma. mas envez de uma ação, terá o novo estado

action_table = {    ('0', 'inicio'):         'S2',
                    ('1', '$'):              'Acc',
                    ('2', 'varinicio'):      'S16',
                    ('3', 'id'):             'S29',
                    ('3', 'leia'):           'S5',
                    ('3', 'escreva'):        'S8',
                    ('3', 'se'):             'S38',
                    ('3', 'fim'):            'S4',
                    ('4', '$'):              'R30',
                    ('6', 'pt_v'):           'S7',
                    ('7', 'id'):             'R11',
                    ('7', 'leia'):           'R11',
                    ('7', 'escreva'):        'R11',
                    ('7', 'se'):             'R11',
                    ('7', 'fimse'):          'R11',
                    ('7', 'fim'):            'R11',
                    ('8', 'id'):             'S9',
                    ('8', 'literal'):        'S55',
                    ('8', 'num'):            'S11',
                    ('9', 'pt_v'):           'R15',
                    ('10', 'id'):            'R12',
                    ('10', 'leia'):          'R12',
                    ('10', 'escreva'):       'R12',
                    ('10', 'se'):            'R12',
                    ('10', 'fimse'):         'R12',
                    ('10', 'fim'):           'R12',
                    ('11', 'pt_v'):          'R14',
                    ('12', 'pt_v'):          'S10',
                    ('13', 'id'):            'S29',
                    ('13', 'se'):            'S38',
                    ('13', 'fim'):           'S4',
                    ('14', 'id'):            'S29',
                    ('14', 'leia'):          'S5',
                    ('14', 'escreva'):       'S8',
                    ('14', 'se'):            'S38',
                    ('14', 'fim'):           'S4',
                    ('15', '$'):             'R2',
                    ('16', 'id'):            'S20',
                    ('16', 'varfim'):        'S18',
                    ('17', 'id'):            'R3',
                    ('17', 'leia'):          'R3',
                    ('17', 'escreva'):       'R3',
                    ('17', 'se'):            'R3',
                    ('17', 'fimse'):         'R3',
                    ('17', 'fim'):           'R3',
                    ('18', 'pt_v'):          'S57',
                    ('19', 'id'):            'S20',
                    ('19', 'varfim'):        'S18',
                    ('20', 'int'):           'S22',
                    ('20', 'real'):          'S23',
                    ('20', 'lit'):           'S24',
                    ('21', 'id'):            'R4',
                    ('21', 'leia'):          'R4',
                    ('21', 'escreva'):       'R4',
                    ('21', 'se'):            'R4',
                    ('21', 'fim'):           'R4',
                    ('22', 'pt_v'):          'R7',
                    ('23', 'pt_v'):          'R8',
                    ('24', 'pt_v'):          'R9',
                    ('25', 'pt_v'):          'S26',
                    ('26', 'id'):            'R6',
                    ('26', 'varfim'):        'R6',
                    ('27', '$'):             'R10',
                    ('28', 'id'):            'S29',
                    ('28', 'leia'):          'S5',
                    ('28', 'escreva'):       'S8',
                    ('28', 'se'):            'S38',
                    ('28', 'fim'):           'S4',
                    ('29', 'rcb'):           'S30',
                    ('30', 'id'):            'S31',
                    ('30', 'num'):           'S32',
                    ('31', 'pt_v'):          'R20',
                    ('31', 'opm'):           'R20',
                    ('31', 'opr'):           'R20',
                    ('31', 'fc_p'):       	 'R20',
                    ('32', 'pt_v'):          'R21',
                    ('32', 'opm'):           'R21',
                    ('32', 'opr'):           'R21',
                    ('32', 'fc_p'):       	 'R21',
                    ('33', 'pt_v'):       	 'S34',
                    ('34', 'id'):            'R17',
                    ('34', 'leia'):          'R17',
                    ('34', 'escreva'):       'R17',
                    ('34', 'se'):            'R17',
                    ('34', 'fimse'):         'R17',
                    ('34', 'fim'):           'R17',
                    ('35', 'pt_v'):          'R19',
                    ('35', 'opm'):           'S36',
                    ('36', 'id'):            'S31',
                    ('36', 'num'):           'S32',
                    ('37', 'id'):            'S29',
                    ('37', 'leia'):          'S5',
                    ('37', 'escreva'):       'S8',
                    ('37', 'se'):            'S38',
                    ('37', 'fimse'):         'S49',
                    ('38', 'ab_p'):          'S39',
                    ('39', 'id'):            'S31',
                    ('39', 'num'):           'S32',
                    ('40', 'fc_p'):       	 'S41',
                    ('41', 'entao'):         'S42',
                    ('42', 'id'):            'R24',
                    ('42', 'leia'):          'R24',
                    ('42', 'escreva'):       'R24',
                    ('42', 'se'):            'R24',
                    ('42', 'fimse'):         'R24',
                    ('42', 'fim'):           'R24',
                    ('43', 'opr'):           'S44',
                    ('44', 'id'):            'S31',
                    ('44', 'num'):           'S32',
                    ('45', 'pt_v'):          'R18',
                    ('46', 'fc_p'):          'R25',
                    ('47', 'id'):            'R23',
                    ('47', 'leia'):          'R23',
                    ('47', 'escreva'):       'R23',
                    ('47', 'se'):            'R23',
                    ('47', 'fimse'):         'R23',
                    ('47', 'fim'):           'R23',
                    ('48', 'id'):            'S29',
                    ('48', 'leia'):          'S5',
                    ('48', 'escreva'):       'S8',
                    ('48', 'se'):            'S38',
                    ('48', 'fimse'):         'S49',
                    ('49', 'id'):            'R29',
                    ('49', 'leia'):          'R29',
                    ('49', 'escreva'):       'R29',
                    ('49', 'se'):            'R29',
                    ('49', 'fimse'):         'R29',
                    ('49', 'fim'):           'R29',
                    ('50', 'id'):            'S29',
                    ('50', 'leia'):          'S5',
                    ('50', 'escreva'):       'S8',
                    ('50', 'se'):            'S38',
                    ('50', 'fimse'):         'S49',
                    ('51', 'id'):            'R26',
                    ('51', 'leia'):          'R26',
                    ('51', 'escreva'):       'R26',
                    ('51', 'se'):            'R26',
                    ('51', 'fimse'):         'R26',
                    ('51', 'fim'):           'R26',
                    ('52', 'id'):            'S29',
                    ('52', 'leia'):          'S5',
                    ('52', 'escreva'):       'S8',
                    ('52', 'se'):            'S38',
                    ('52', 'fimse'):         'S49',
                    ('53', 'id'):            'R28',
                    ('53', 'leia'):          'R28',
                    ('53', 'escreva'):       'R28',
                    ('53', 'se'):            'R28',
                    ('53', 'fimse'):         'R28',
                    ('53', 'fim'):           'R28',
                    ('54', '$'):             'R16',
                    ('55', 'pt_v'):          'R13',
                    ('56', 'id'):            'R27',
                    ('56', 'leia'):          'R27',
                    ('56', 'escreva'):       'R27',
                    ('56', 'se'):            'R27',
                    ('56', 'fimse'):         'R27',
                    ('56', 'fim'):           'R27',
                    ('57', 'id'):            'R5',
                    ('57', 'leia'):          'R5',
                    ('57', 'escreva'):       'R5',
                    ('57', 'se'):            'R5',
                    ('57', 'fim'):           'R5',
                    ('58', '$'):             'R22'
}

goto_table = {      ('0', 'P'):              '1',
                    ('2', 'v'):              '3',
                    ('3', 'A'):              '15',
                    ('3', 'ES'):             '13',
                    ('3', 'CMD'):            '14',
                    ('3', 'COND'):           '28',
                    ('3', 'CABEÇALHO'):      '37',
                    ('8', 'ARG'):            '12',
                    ('13', 'A'):             '27',
                    ('13', 'CMD'):           '14',
                    ('13', 'COND'):          '28',
                    ('13', 'CABEÇALHO'):     '37',
                    ('14', 'A'):             '54',
                    ('14', 'ES'):            '13',
                    ('14', 'CMD'):           '14',
                    ('14', 'COND'):          '28',
                    ('14', 'CABEÇALHO'):     '37',
                    ('16', 'LV'):            '17',
                    ('16', 'D'):             '19',
                    ('19', 'LV'):            '21',
                    ('19', 'D'):             '19',
                    ('20', 'TIPO'):          '25',
                    ('28', 'A'):             '58',
                    ('28', 'ES'):            '13',
                    ('28', 'CMD'):           '14',
                    ('28', 'COND'):          '28',
                    ('28', 'CABEÇALHO'):     '37',
                    ('30', 'LD'):            '33',
                    ('30', 'OPRD'):          '35',
                    ('36', 'OPRD'):          '45',
                    ('37', 'ES'):            '48',
                    ('37', 'CMD'):           '50',
                    ('37', 'COND'):          '52',
                    ('37', 'CABEÇALHO'):     '37',
                    ('37', 'CORPO'):         '47',
                    ('39', 'OPRD'):          '43',
                    ('39', 'EXP_R'):         '40',
                    ('44', 'OPRD'):          '46',
                    ('48', 'ES'):            '48',
                    ('48', 'CMD'):           '50',
                    ('48', 'COND'):          '52',
                    ('48', 'CABEÇALHO'):     '37',
                    ('48', 'CORPO'):         '51',
                    ('50', 'ES'):            '48',
                    ('50', 'CMD'):           '50',
                    ('50', 'COND'):          '52',
                    ('50', 'CABEÇALHO'):     '37',
                    ('50', 'CORPO'):         '56',
                    ('52', 'ES'):            '48',
                    ('52', 'CMD'):           '50',
                    ('52', 'COND'):          '52',
                    ('52', 'CABEÇALHO'):     '37',
                    ('52', 'CORPO'):         '53'
}

table = SyntacticTable(_action_table=action_table, _goto_table=goto_table)
initial_state = '0'

lr_automaton = StackAutomata(_table=table, _initial_state=initial_state)
